<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Example of MuDirac Usage &mdash; MuDirac documentation November 16, 2020 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=663b5c8f"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Input keywords" href="keywords.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            MuDirac documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation of MuDirac</a></li>
<li class="toctree-l1"><a class="reference internal" href="theory.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="keywords.html">Input keywords</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Example of MuDirac Usage</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MuDirac documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Example of MuDirac Usage</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/example.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="example-of-mudirac-usage">
<h1>Example of MuDirac Usage<a class="headerlink" href="#example-of-mudirac-usage" title="Link to this heading"></a></h1>
<p>To learn how to use mudirac, let’s try a simple example. Open a text editor and write the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>element:<span class="w"> </span>Au
isotope:<span class="w"> </span><span class="m">197</span>
xr_lines:<span class="w"> </span>K1-L2,K1-L3
write_spec:<span class="w"> </span>T
</pre></div>
</div>
<p>Save this as <code class="docutils literal notranslate"><span class="pre">Au_basic.in</span></code> and then pass it to MuDirac. The simulation should be really fast and it should produce the files <code class="docutils literal notranslate"><span class="pre">Au_basic.xr.out</span></code>, <code class="docutils literal notranslate"><span class="pre">Au_basic.log</span></code>, <code class="docutils literal notranslate"><span class="pre">Au_basic.err</span></code> and <code class="docutils literal notranslate"><span class="pre">Au_basic.spec.dat</span></code>. The <code class="docutils literal notranslate"><span class="pre">.log</span></code> and <code class="docutils literal notranslate"><span class="pre">.err</span></code> files are just a log of the program’s calculations and a file where any errors are stored; they are not important unless you’re trying to figure out what went wrong in a failed calculation. The <code class="docutils literal notranslate"><span class="pre">.xr.out</span></code> file contains a text summary of the result, and the <code class="docutils literal notranslate"><span class="pre">.spec.dat</span></code> file contains tabulated data for a simulated spectrum. Let’s look at the input file and at what each line does.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">element</span><span class="p">:</span> <span class="n">Au</span><span class="p">;</span> <span class="n">isotope</span><span class="p">:</span> <span class="mi">197</span>
</pre></div>
</div>
<p>This specifies that we’re interested in studying gold, specifically the 197-Au isotope.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xr_lines</span><span class="p">:</span> <span class="n">K1</span><span class="o">-</span><span class="n">L2</span><span class="p">,</span><span class="n">K1</span><span class="o">-</span><span class="n">L3</span>
</pre></div>
</div>
<p>This indicates which X-ray transitions we want to know about. The notation is the IUPAC standard notation for X-ray spectrometry. These would be the transitions connecting the 1s shell (K1) to the 2p1/2 and 2p3/2 shells (L2, L3). Remember that because these orbitals are relativistic, spin-orbit coupling is built into them, and orbitals with different total angular momentum (orbital + spin) have different energies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">write_spec</span><span class="p">:</span> <span class="n">T</span>
</pre></div>
</div>
<p>Finally, this tells to the program to write also a <code class="docutils literal notranslate"><span class="pre">.spec.dat</span></code> file. Without this line, it wouldn’t be created. T here stands for True.</p>
<p>Now open the <code class="docutils literal notranslate"><span class="pre">Au_basic.xr.out</span></code> file. The contents should look something like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Z = 79, A = 197 amu, m = 206.768 au</span>
Line<span class="w">    </span>DeltaE<span class="w"> </span><span class="o">(</span>eV<span class="o">)</span><span class="w">     </span>W_12<span class="w"> </span><span class="o">(</span>s^-1<span class="o">)</span>
K1-L2<span class="w">   </span><span class="m">1</span>.43693e+07<span class="w">             </span><span class="m">4</span>.94871e+18
K1-L3<span class="w">   </span><span class="m">1</span>.48315e+07<span class="w">             </span><span class="m">4</span>.63201e+18
</pre></div>
</div>
<p>The first line is a header that records the context of the calculation - the element’s atomic number and atomic mass, and the mass of the particle in atomic units (for a muon this will always be 206.768 au). The next lines show for each line the transition energy in electron volts and the transition rate in 1/seconds, which connects to the relative intensity of the line in the spectrum. Generally speaking, lines with higher transition rates will be stronger, though the connection isn’t perfect as there are other factors at play.</p>
<p>Now, this result is achieved with the default settings, that are in fact insufficient to simulate accurately an atom with a large Z like gold; as a general rule, the higher the charge of a nucleus, the more important all the additional terms. Copy <code class="docutils literal notranslate"><span class="pre">Au_basic.in</span></code> as <code class="docutils literal notranslate"><span class="pre">Au.in</span></code> and edit it to add lines so that it looks like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>element:<span class="w"> </span>Au
isotope:<span class="w"> </span><span class="m">197</span>
xr_lines:<span class="w"> </span>K1-L2,K1-L3
write_spec:<span class="w"> </span>T
nuclear_model:<span class="w"> </span>FERMI2
uehling_correction:<span class="w"> </span>T
electronic_config:<span class="w"> </span>Au
</pre></div>
</div>
<p>This adds three more lines:</p>
<p><code class="docutils literal notranslate"><span class="pre">nuclear_model:</span> <span class="pre">FERMI2</span></code>: This sets the nucleus to be modelled not as a point charge, but as a Fermi 2-term charge distribution, which is far more accurate to reality. The program contains parameters for this distribution for all isotopes of interest in the periodic table. This will account for the finite size of the nucleus, and the overlap of the muon orbitals with it.</p>
<p><code class="docutils literal notranslate"><span class="pre">uehling_correction:</span> <span class="pre">T</span></code>: This accounts for the Uehling correction, a quantum field effect relevant to electrostatics at these high energies. It can be undestood as accounting for the vacuum itself acting as a polarizable medium; because virtual electron-positron pairs can be generated in quantum field theory, these partially shield the charges and lower the traditional Coulomb force. This is an important term especially for very massive nuclei like Au or Pb and orbitals close to the nucleus.</p>
<p><code class="docutils literal notranslate"><span class="pre">electronic_config:</span> <span class="pre">Au</span></code>: This term includes approximatively the effect of the other electrons orbiting the nucleus. It does not solve the equations for them, rather it just places them in fixed idealised orbitals and builds a negative charge background from them. The result is an additional correction to the energy, that is however tiny compared to the previous two terms, and often easily ignored.</p>
<p>Try running again MuDirac with this input. The calculation should take longer, and this time the output in <code class="docutils literal notranslate"><span class="pre">Au.xr.out</span></code> should be:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Z = 79, A = 197 amu, m = 206.768 au</span>
Line<span class="w">    </span>DeltaE<span class="w"> </span><span class="o">(</span>eV<span class="o">)</span><span class="w">     </span>W_12<span class="w"> </span><span class="o">(</span>s^-1<span class="o">)</span>
K1-L2<span class="w">   </span><span class="m">5</span>.5936e+06<span class="w">              </span><span class="m">1</span>.62308e+18
K1-L3<span class="w">   </span><span class="m">5</span>.76294e+06<span class="w">             </span><span class="m">1</span>.76987e+18
</pre></div>
</div>
<p>Note the significant changes - the energies are almost three times smaller than previously! You can try removing each of the new terms individually, or commenting them out by adding <code class="docutils literal notranslate"><span class="pre">#</span></code> at the beginning of a line, and re-running to see their effects. Now to familiarize yourself you can try a few more things:</p>
<ol class="arabic simple">
<li><p>try adding more <code class="docutils literal notranslate"><span class="pre">xr_lines</span></code>, for example L1-M2 and L1-M3;</p></li>
<li><p>try adding a range of lines; this can be written as K1:M5-K1:M5. It will compute all transitions within the given ranges that obey the selection rules to be allowed;</p></li>
<li><p>try plotting the spectra in the <code class="docutils literal notranslate"><span class="pre">.spec.dat</span> <span class="pre">files</span></code>, using Gnuplot or importing them in software like Excel or Origin.</p></li>
</ol>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="keywords.html" class="btn btn-neutral float-left" title="Input keywords" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Simone Sturniolo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>